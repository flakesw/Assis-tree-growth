legend("topright", legend = c("Soils Alone", "Full Model"), col = c("magenta", "darkblue"),
lty = 1)
mtext(side = 1, line = 5, text = "pH                                      C.E.C.", cex = 1.4)
mtext(side = 3, line = 1, text = "(a)", at = -1.5, cex = 1.4)
arrows(x0 = -1.5, x1 = 2, y0 = 0.007, y1 = 0.007, xpd = TRUE, code = 3, length = 0.125)
# panel for soil pc2
eff <- Effect(focal.predictors = c("PC2"),
mod = ft_ci_soils_lmm, xlevels = 100, transformation = list(link = log, inverse = exp),
partial.residuals = TRUE,
se = TRUE)
y <- eff$fit
x <- eff[["x"]]$PC2
x.fit <- eff[["x.all"]]$PC2
fitted <- y[closest(x.fit, x)]
resids <- eff$residuals + fitted
exp_resids <- exp(resids)
resid_df <- data.frame(x.fit,
resids)
e1_r_agg <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = mean)[, c(2,3)]
e1_r_agg[, 3] <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = se)[, 3]
names(e1_r_agg) <- c("x.fit", "mean_part_resids", "se_resids")
e1_r_agg$low <- e1_r_agg$mean_part_resids - e1_r_agg$se_resids
e1_r_agg$high <- e1_r_agg$mean_part_resids + e1_r_agg$se_resids
e1_r_agg$exp_low <- exp(e1_r_agg$mean_part_resids - e1_r_agg$se_resids)
e1_r_agg$exp_high <- exp(e1_r_agg$mean_part_resids + e1_r_agg$se_resids)
e1_r_agg$exp_mean_resids <- exp(e1_r_agg[, 2])
eff2 <- Effect(focal.predictors = c("PC2"),
mod = eval(eval(mod4)), xlevels = 100, transformation = list(link = log, inverse = exp))
dat <- data.frame(y = exp(eff$fit),
lower = exp(eff$lower),
upper = exp(eff$upper),
soil = eff[["x"]][["PC2"]])
dat2 <- data.frame(y = exp(eff2$fit),
lower = exp(eff2$lower),
upper = exp(eff2$upper),
soil = eff2[["x"]][["PC2"]])
plot(x = NA,
xlim = c(-1.5,2),
ylim = c(0.08, 0.3),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n")
points(e1_r_agg$exp_mean_resids ~ e1_r_agg$x.fit,
pch = 21,
bg= "darkblue",
col = "darkblue")
arrows(y0 = e1_r_agg$exp_low, x0 = e1_r_agg$x.fit,
y1 = e1_r_agg$exp_high, x1 = e1_r_agg$x.fit,
code = 3,
angle = 90,
length = 0.02,
lwd = 0.5)
lines(dat$y ~ dat$soil, col = "darkblue", lwd = 2)
polygon(c(dat$soil, rev(dat$soil)), c(dat$upper, rev(dat$lower)),
col = addTrans("darkblue",30), border = NA)
lines(dat2$y ~ dat2$soil, col = "magenta", lwd = 2)
polygon(c(dat2$soil, rev(dat2$soil)), c(dat2$upper, rev(dat2$lower)),
col = addTrans("magenta",30), border = NA)
mtext(side = 1, text = "Soil PC2", line = 2.7, cex = 1.8)
mtext(side = 2, text = expression(paste("Diameter increment (cm year"^"-1", ")")),
line = 2.7, cex = 1.8)
axis(side =1, cex.axis = 1.5, at = c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2),
labels = c(NA, -1, NA, 0, NA, 1, NA, 2))
axis(side =2, cex.axis = 1.5)
legend("topright", legend = c("Soils Alone", "Full Model"), col = c("magenta", "darkblue"),
lty = 1)
mtext(side = 1, line = 5, text = "Fewer Bases                 More Bases", cex = 1.4)
mtext(side = 3, line = 1, text = "(b)", at = -1.5, cex = 1.4)
arrows(x0 = -1.5, x1 = 2, y0 = 0.007, y1 = 0.007, xpd = TRUE, code = 3, length = 0.125)
dev.off()
text(x = -1.5, y = 0.3, labels = "(a)", cex = 1.4)
tiff(filename="./plots/Figure 3 soil variables effect plot with partial residuals.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 3,
height=6,
pointsize=7,
res=600)
par(mar = c(7.4, 5.1, 2, 1),
oma = c(0,1,1,0),
mfrow = c(2,1))
eff <- Effect(focal.predictors = c("PC1"),
mod = ft_ci_soils_lmm, xlevels = 100, transformation = list(link = log, inverse = exp),
partial.residuals = TRUE,
se = TRUE)
y <- eff$fit
x <- eff[["x"]]$PC1
x.fit <- eff[["x.all"]]$PC1
fitted <- y[closest(x.fit, x)]
resids <- eff$residuals + fitted
exp_resids <- exp(resids)
resid_df <- data.frame(x.fit,
resids)
e1_r_agg <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = mean)[, c(2,3)]
e1_r_agg[, 3] <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = se)[, 3]
names(e1_r_agg) <- c("x.fit", "mean_part_resids", "se_resids")
e1_r_agg$low <- e1_r_agg$mean_part_resids - e1_r_agg$se_resids
e1_r_agg$high <- e1_r_agg$mean_part_resids + e1_r_agg$se_resids
e1_r_agg$exp_low <- exp(e1_r_agg$mean_part_resids - e1_r_agg$se_resids)
e1_r_agg$exp_high <- exp(e1_r_agg$mean_part_resids + e1_r_agg$se_resids)
e1_r_agg$exp_mean_resids <- exp(e1_r_agg[, 2])
eff2 <- Effect(focal.predictors = c("PC1"),
mod = eval(eval(mod4)), xlevels = 100, transformation = list(link = log, inverse = exp))
dat <- data.frame(y = exp(eff$fit),
lower = exp(eff$lower),
upper = exp(eff$upper),
soil = eff[["x"]][["PC1"]])
dat2 <- data.frame(y = exp(eff2$fit),
lower = exp(eff2$lower),
upper = exp(eff2$upper),
soil = eff2[["x"]][["PC1"]])
plot(x = NA,
xlim = c(-1.5, 2),
ylim = c(0.08, 0.3),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n")
points(e1_r_agg$exp_mean_resids ~ e1_r_agg$x.fit,
pch = 21,
bg= "darkblue",
col = "darkblue")
arrows(y0 = e1_r_agg$exp_low, x0 = e1_r_agg$x.fit,
y1 = e1_r_agg$exp_high, x1 = e1_r_agg$x.fit,
code = 3,
angle = 90,
length = 0.02,
lwd = 0.5)
lines(dat$y ~ dat$soil, col = "darkblue", lwd = 2)
polygon(c(dat$soil, rev(dat$soil)), c(dat$upper, rev(dat$lower)),
col = addTrans("darkblue",30), border = NA)
lines(dat2$y ~ dat2$soil, col = "magenta", lwd = 2)
polygon(c(dat2$soil, rev(dat2$soil)), c(dat2$upper, rev(dat2$lower)),
col = addTrans("magenta",30), border = NA)
mtext(side = 1, text = "Soil PC1", line = 2.7, cex = 1.8)
mtext(side = 2, text = expression(paste("Diameter increment (cm year"^"-1", ")")),
line = 2.7, cex = 1.8)
axis(side =1, cex.axis = 1.5,at = c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2),
labels = c(NA, -1, NA, 0, NA, 1, NA, 2))
axis(side =2, cex.axis = 1.5)
legend("topright", legend = c("Soils Alone", "Full Model"), col = c("magenta", "darkblue"),
lty = 1)
mtext(side = 1, line = 5, text = "pH                                      C.E.C.", cex = 1.4)
text(x = -1.5, y = 0.3, labels = "(a)", cex = 1.4)
arrows(x0 = -1.5, x1 = 2, y0 = 0.007, y1 = 0.007, xpd = TRUE, code = 3, length = 0.125)
# panel for soil pc2
eff <- Effect(focal.predictors = c("PC2"),
mod = ft_ci_soils_lmm, xlevels = 100, transformation = list(link = log, inverse = exp),
partial.residuals = TRUE,
se = TRUE)
y <- eff$fit
x <- eff[["x"]]$PC2
x.fit <- eff[["x.all"]]$PC2
fitted <- y[closest(x.fit, x)]
resids <- eff$residuals + fitted
exp_resids <- exp(resids)
resid_df <- data.frame(x.fit,
resids)
e1_r_agg <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = mean)[, c(2,3)]
e1_r_agg[, 3] <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = se)[, 3]
names(e1_r_agg) <- c("x.fit", "mean_part_resids", "se_resids")
e1_r_agg$low <- e1_r_agg$mean_part_resids - e1_r_agg$se_resids
e1_r_agg$high <- e1_r_agg$mean_part_resids + e1_r_agg$se_resids
e1_r_agg$exp_low <- exp(e1_r_agg$mean_part_resids - e1_r_agg$se_resids)
e1_r_agg$exp_high <- exp(e1_r_agg$mean_part_resids + e1_r_agg$se_resids)
e1_r_agg$exp_mean_resids <- exp(e1_r_agg[, 2])
eff2 <- Effect(focal.predictors = c("PC2"),
mod = eval(eval(mod4)), xlevels = 100, transformation = list(link = log, inverse = exp))
dat <- data.frame(y = exp(eff$fit),
lower = exp(eff$lower),
upper = exp(eff$upper),
soil = eff[["x"]][["PC2"]])
dat2 <- data.frame(y = exp(eff2$fit),
lower = exp(eff2$lower),
upper = exp(eff2$upper),
soil = eff2[["x"]][["PC2"]])
plot(x = NA,
xlim = c(-1.5,2),
ylim = c(0.08, 0.3),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n")
points(e1_r_agg$exp_mean_resids ~ e1_r_agg$x.fit,
pch = 21,
bg= "darkblue",
col = "darkblue")
arrows(y0 = e1_r_agg$exp_low, x0 = e1_r_agg$x.fit,
y1 = e1_r_agg$exp_high, x1 = e1_r_agg$x.fit,
code = 3,
angle = 90,
length = 0.02,
lwd = 0.5)
lines(dat$y ~ dat$soil, col = "darkblue", lwd = 2)
polygon(c(dat$soil, rev(dat$soil)), c(dat$upper, rev(dat$lower)),
col = addTrans("darkblue",30), border = NA)
lines(dat2$y ~ dat2$soil, col = "magenta", lwd = 2)
polygon(c(dat2$soil, rev(dat2$soil)), c(dat2$upper, rev(dat2$lower)),
col = addTrans("magenta",30), border = NA)
mtext(side = 1, text = "Soil PC2", line = 2.7, cex = 1.8)
mtext(side = 2, text = expression(paste("Diameter increment (cm year"^"-1", ")")),
line = 2.7, cex = 1.8)
axis(side =1, cex.axis = 1.5, at = c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2),
labels = c(NA, -1, NA, 0, NA, 1, NA, 2))
axis(side =2, cex.axis = 1.5)
legend("topright", legend = c("Soils Alone", "Full Model"), col = c("magenta", "darkblue"),
lty = 1)
mtext(side = 1, line = 5, text = "Fewer Bases                 More Bases", cex = 1.4)
text(x = -1.5, y = 0.3, labels = "(b)", cex = 1.4)
arrows(x0 = -1.5, x1 = 2, y0 = 0.007, y1 = 0.007, xpd = TRUE, code = 3, length = 0.125)
dev.off()
tiff(filename="./plots/Figure 3 soil variables effect plot with partial residuals.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 3,
height=6,
pointsize=7,
res=600)
par(mar = c(7.4, 5.1, 2, 1),
oma = c(0,1,1,0),
mfrow = c(2,1))
eff <- Effect(focal.predictors = c("PC1"),
mod = ft_ci_soils_lmm, xlevels = 100, transformation = list(link = log, inverse = exp),
partial.residuals = TRUE,
se = TRUE)
y <- eff$fit
x <- eff[["x"]]$PC1
x.fit <- eff[["x.all"]]$PC1
fitted <- y[closest(x.fit, x)]
resids <- eff$residuals + fitted
exp_resids <- exp(resids)
resid_df <- data.frame(x.fit,
resids)
e1_r_agg <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = mean)[, c(2,3)]
e1_r_agg[, 3] <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = se)[, 3]
names(e1_r_agg) <- c("x.fit", "mean_part_resids", "se_resids")
e1_r_agg$low <- e1_r_agg$mean_part_resids - e1_r_agg$se_resids
e1_r_agg$high <- e1_r_agg$mean_part_resids + e1_r_agg$se_resids
e1_r_agg$exp_low <- exp(e1_r_agg$mean_part_resids - e1_r_agg$se_resids)
e1_r_agg$exp_high <- exp(e1_r_agg$mean_part_resids + e1_r_agg$se_resids)
e1_r_agg$exp_mean_resids <- exp(e1_r_agg[, 2])
eff2 <- Effect(focal.predictors = c("PC1"),
mod = eval(eval(mod4)), xlevels = 100, transformation = list(link = log, inverse = exp))
dat <- data.frame(y = exp(eff$fit),
lower = exp(eff$lower),
upper = exp(eff$upper),
soil = eff[["x"]][["PC1"]])
dat2 <- data.frame(y = exp(eff2$fit),
lower = exp(eff2$lower),
upper = exp(eff2$upper),
soil = eff2[["x"]][["PC1"]])
plot(x = NA,
xlim = c(-1.5, 2),
ylim = c(0.08, 0.3),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n")
points(e1_r_agg$exp_mean_resids ~ e1_r_agg$x.fit,
pch = 21,
bg= "darkblue",
col = "darkblue")
arrows(y0 = e1_r_agg$exp_low, x0 = e1_r_agg$x.fit,
y1 = e1_r_agg$exp_high, x1 = e1_r_agg$x.fit,
code = 3,
angle = 90,
length = 0.02,
lwd = 0.5)
lines(dat$y ~ dat$soil, col = "darkblue", lwd = 2)
polygon(c(dat$soil, rev(dat$soil)), c(dat$upper, rev(dat$lower)),
col = addTrans("darkblue",30), border = NA)
lines(dat2$y ~ dat2$soil, col = "magenta", lwd = 2)
polygon(c(dat2$soil, rev(dat2$soil)), c(dat2$upper, rev(dat2$lower)),
col = addTrans("magenta",30), border = NA)
mtext(side = 1, text = "Soil PC1", line = 2.7, cex = 1.8)
mtext(side = 2, text = expression(paste("Diameter increment (cm year"^"-1", ")")),
line = 2.7, cex = 1.8)
axis(side =1, cex.axis = 1.5,at = c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2),
labels = c(NA, -1, NA, 0, NA, 1, NA, 2))
axis(side =2, cex.axis = 1.5)
legend("topright", legend = c("Soils Alone", "Full Model"), col = c("magenta", "darkblue"),
lty = 1)
mtext(side = 1, line = 5, text = "pH                                      C.E.C.", cex = 1.4)
text(x = -1.4, y = 0.27, labels = "(a)", cex = 1.4)
arrows(x0 = -1.5, x1 = 2, y0 = 0.007, y1 = 0.007, xpd = TRUE, code = 3, length = 0.125)
# panel for soil pc2
eff <- Effect(focal.predictors = c("PC2"),
mod = ft_ci_soils_lmm, xlevels = 100, transformation = list(link = log, inverse = exp),
partial.residuals = TRUE,
se = TRUE)
y <- eff$fit
x <- eff[["x"]]$PC2
x.fit <- eff[["x.all"]]$PC2
fitted <- y[closest(x.fit, x)]
resids <- eff$residuals + fitted
exp_resids <- exp(resids)
resid_df <- data.frame(x.fit,
resids)
e1_r_agg <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = mean)[, c(2,3)]
e1_r_agg[, 3] <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = se)[, 3]
names(e1_r_agg) <- c("x.fit", "mean_part_resids", "se_resids")
e1_r_agg$low <- e1_r_agg$mean_part_resids - e1_r_agg$se_resids
e1_r_agg$high <- e1_r_agg$mean_part_resids + e1_r_agg$se_resids
e1_r_agg$exp_low <- exp(e1_r_agg$mean_part_resids - e1_r_agg$se_resids)
e1_r_agg$exp_high <- exp(e1_r_agg$mean_part_resids + e1_r_agg$se_resids)
e1_r_agg$exp_mean_resids <- exp(e1_r_agg[, 2])
eff2 <- Effect(focal.predictors = c("PC2"),
mod = eval(eval(mod4)), xlevels = 100, transformation = list(link = log, inverse = exp))
dat <- data.frame(y = exp(eff$fit),
lower = exp(eff$lower),
upper = exp(eff$upper),
soil = eff[["x"]][["PC2"]])
dat2 <- data.frame(y = exp(eff2$fit),
lower = exp(eff2$lower),
upper = exp(eff2$upper),
soil = eff2[["x"]][["PC2"]])
plot(x = NA,
xlim = c(-1.5,2),
ylim = c(0.08, 0.3),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n")
points(e1_r_agg$exp_mean_resids ~ e1_r_agg$x.fit,
pch = 21,
bg= "darkblue",
col = "darkblue")
arrows(y0 = e1_r_agg$exp_low, x0 = e1_r_agg$x.fit,
y1 = e1_r_agg$exp_high, x1 = e1_r_agg$x.fit,
code = 3,
angle = 90,
length = 0.02,
lwd = 0.5)
lines(dat$y ~ dat$soil, col = "darkblue", lwd = 2)
polygon(c(dat$soil, rev(dat$soil)), c(dat$upper, rev(dat$lower)),
col = addTrans("darkblue",30), border = NA)
lines(dat2$y ~ dat2$soil, col = "magenta", lwd = 2)
polygon(c(dat2$soil, rev(dat2$soil)), c(dat2$upper, rev(dat2$lower)),
col = addTrans("magenta",30), border = NA)
mtext(side = 1, text = "Soil PC2", line = 2.7, cex = 1.8)
mtext(side = 2, text = expression(paste("Diameter increment (cm year"^"-1", ")")),
line = 2.7, cex = 1.8)
axis(side =1, cex.axis = 1.5, at = c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2),
labels = c(NA, -1, NA, 0, NA, 1, NA, 2))
axis(side =2, cex.axis = 1.5)
legend("topright", legend = c("Soils Alone", "Full Model"), col = c("magenta", "darkblue"),
lty = 1)
mtext(side = 1, line = 5, text = "Fewer Bases                 More Bases", cex = 1.4)
text(x = -1.4, y = 0.27, labels = "(b)", cex = 1.4)
arrows(x0 = -1.5, x1 = 2, y0 = 0.007, y1 = 0.007, xpd = TRUE, code = 3, length = 0.125)
dev.off()
tiff(filename="./plots/Figure 3 soil variables effect plot with partial residuals.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 3,
height=6,
pointsize=7,
res=600)
par(mar = c(7.4, 5.1, 2, 1),
oma = c(0,1,1,0),
mfrow = c(2,1))
eff <- Effect(focal.predictors = c("PC1"),
mod = ft_ci_soils_lmm, xlevels = 100, transformation = list(link = log, inverse = exp),
partial.residuals = TRUE,
se = TRUE)
y <- eff$fit
x <- eff[["x"]]$PC1
x.fit <- eff[["x.all"]]$PC1
fitted <- y[closest(x.fit, x)]
resids <- eff$residuals + fitted
exp_resids <- exp(resids)
resid_df <- data.frame(x.fit,
resids)
e1_r_agg <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = mean)[, c(2,3)]
e1_r_agg[, 3] <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = se)[, 3]
names(e1_r_agg) <- c("x.fit", "mean_part_resids", "se_resids")
e1_r_agg$low <- e1_r_agg$mean_part_resids - e1_r_agg$se_resids
e1_r_agg$high <- e1_r_agg$mean_part_resids + e1_r_agg$se_resids
e1_r_agg$exp_low <- exp(e1_r_agg$mean_part_resids - e1_r_agg$se_resids)
e1_r_agg$exp_high <- exp(e1_r_agg$mean_part_resids + e1_r_agg$se_resids)
e1_r_agg$exp_mean_resids <- exp(e1_r_agg[, 2])
eff2 <- Effect(focal.predictors = c("PC1"),
mod = eval(eval(mod4)), xlevels = 100, transformation = list(link = log, inverse = exp))
dat <- data.frame(y = exp(eff$fit),
lower = exp(eff$lower),
upper = exp(eff$upper),
soil = eff[["x"]][["PC1"]])
dat2 <- data.frame(y = exp(eff2$fit),
lower = exp(eff2$lower),
upper = exp(eff2$upper),
soil = eff2[["x"]][["PC1"]])
plot(x = NA,
xlim = c(-1.5, 2),
ylim = c(0.08, 0.3),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n")
points(e1_r_agg$exp_mean_resids ~ e1_r_agg$x.fit,
pch = 21,
bg= "darkblue",
col = "darkblue")
arrows(y0 = e1_r_agg$exp_low, x0 = e1_r_agg$x.fit,
y1 = e1_r_agg$exp_high, x1 = e1_r_agg$x.fit,
code = 3,
angle = 90,
length = 0.02,
lwd = 0.5)
lines(dat$y ~ dat$soil, col = "darkblue", lwd = 2)
polygon(c(dat$soil, rev(dat$soil)), c(dat$upper, rev(dat$lower)),
col = addTrans("darkblue",30), border = NA)
lines(dat2$y ~ dat2$soil, col = "magenta", lwd = 2)
polygon(c(dat2$soil, rev(dat2$soil)), c(dat2$upper, rev(dat2$lower)),
col = addTrans("magenta",30), border = NA)
mtext(side = 1, text = "Soil PC1", line = 2.7, cex = 1.8)
mtext(side = 2, text = expression(paste("Diameter increment (cm year"^"-1", ")")),
line = 2.7, cex = 1.8)
axis(side =1, cex.axis = 1.5,at = c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2),
labels = c(NA, -1, NA, 0, NA, 1, NA, 2))
axis(side =2, cex.axis = 1.5)
legend("topright", legend = c("Soils Alone", "Full Model"), col = c("magenta", "darkblue"),
lty = 1)
text(x = -1.4, y = 0.29, labels = "(a)", cex = 1.4)
mtext(side = 1, line = 5, text = "pH                                      C.E.C.", cex = 1.4)
arrows(x0 = -1.5, x1 = 2, y0 = 0.007, y1 = 0.007, xpd = TRUE, code = 3, length = 0.125)
# panel for soil pc2
eff <- Effect(focal.predictors = c("PC2"),
mod = ft_ci_soils_lmm, xlevels = 100, transformation = list(link = log, inverse = exp),
partial.residuals = TRUE,
se = TRUE)
y <- eff$fit
x <- eff[["x"]]$PC2
x.fit <- eff[["x.all"]]$PC2
fitted <- y[closest(x.fit, x)]
resids <- eff$residuals + fitted
exp_resids <- exp(resids)
resid_df <- data.frame(x.fit,
resids)
e1_r_agg <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = mean)[, c(2,3)]
e1_r_agg[, 3] <- aggregate(resid_df, by = list(resid_df$x.fit), FUN = se)[, 3]
names(e1_r_agg) <- c("x.fit", "mean_part_resids", "se_resids")
e1_r_agg$low <- e1_r_agg$mean_part_resids - e1_r_agg$se_resids
e1_r_agg$high <- e1_r_agg$mean_part_resids + e1_r_agg$se_resids
e1_r_agg$exp_low <- exp(e1_r_agg$mean_part_resids - e1_r_agg$se_resids)
e1_r_agg$exp_high <- exp(e1_r_agg$mean_part_resids + e1_r_agg$se_resids)
e1_r_agg$exp_mean_resids <- exp(e1_r_agg[, 2])
eff2 <- Effect(focal.predictors = c("PC2"),
mod = eval(eval(mod4)), xlevels = 100, transformation = list(link = log, inverse = exp))
dat <- data.frame(y = exp(eff$fit),
lower = exp(eff$lower),
upper = exp(eff$upper),
soil = eff[["x"]][["PC2"]])
dat2 <- data.frame(y = exp(eff2$fit),
lower = exp(eff2$lower),
upper = exp(eff2$upper),
soil = eff2[["x"]][["PC2"]])
plot(x = NA,
xlim = c(-1.5,2),
ylim = c(0.08, 0.3),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n")
points(e1_r_agg$exp_mean_resids ~ e1_r_agg$x.fit,
pch = 21,
bg= "darkblue",
col = "darkblue")
arrows(y0 = e1_r_agg$exp_low, x0 = e1_r_agg$x.fit,
y1 = e1_r_agg$exp_high, x1 = e1_r_agg$x.fit,
code = 3,
angle = 90,
length = 0.02,
lwd = 0.5)
lines(dat$y ~ dat$soil, col = "darkblue", lwd = 2)
polygon(c(dat$soil, rev(dat$soil)), c(dat$upper, rev(dat$lower)),
col = addTrans("darkblue",30), border = NA)
lines(dat2$y ~ dat2$soil, col = "magenta", lwd = 2)
polygon(c(dat2$soil, rev(dat2$soil)), c(dat2$upper, rev(dat2$lower)),
col = addTrans("magenta",30), border = NA)
mtext(side = 1, text = "Soil PC2", line = 2.7, cex = 1.8)
mtext(side = 2, text = expression(paste("Diameter increment (cm year"^"-1", ")")),
line = 2.7, cex = 1.8)
axis(side =1, cex.axis = 1.5, at = c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2),
labels = c(NA, -1, NA, 0, NA, 1, NA, 2))
axis(side =2, cex.axis = 1.5)
legend("topright", legend = c("Soils Alone", "Full Model"), col = c("magenta", "darkblue"),
lty = 1)
text(x = -1.4, y = 0.29, labels = "(b)", cex = 1.4)
mtext(side = 1, line = 5, text = "Fewer Bases                 More Bases", cex = 1.4)
arrows(x0 = -1.5, x1 = 2, y0 = 0.007, y1 = 0.007, xpd = TRUE, code = 3, length = 0.125)
dev.off()
# let FTs also differ in diameter-growth relationships
# doesn't help AICc
mod7 <- expression((lmer(log(dbh.annual.increment.cm._10.years) ~
scale(log(dg.2006.cm))* C.Cerrado..G.generalist. +
scale(BA.above2011) * C.Cerrado..G.generalist. +
(1|Code),
data = all_data_pos)))
# let FTs also differ in diameter-growth relationships
# doesn't help AICc
mod7 <- ((lmer(log(dbh.annual.increment.cm._10.years) ~
scale(log(dg.2006.cm))* C.Cerrado..G.generalist. +
scale(BA.above2011) * C.Cerrado..G.generalist. +
(1|Code),
data = all_data_pos)))
